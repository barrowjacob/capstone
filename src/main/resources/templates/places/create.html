<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:insert="partials/fragments :: head('Create Place Listing')">

</head>
<body style="background-color: navajowhite">

<nav th:insert="partials/fragments :: nav" class="is-blue"></nav>

<main class="hero is-fullheight-with-navbar is-bold">
   <div class="hero-body columns has-text-centered">
      <div class="container box is-narrow">
         <div class="column is-4 is-offset-4">
            <h1 class="title has-text-dark">
               Rent your own property
            </h1>
         </div>
         <div class="column is-6 is-offset-3">
            <form th:action="@{'/places/' + ${user.id} + '/create'}" method="POST">
               <div class="field is-horizontal">
                  <div class="field-label is-normal">
                     <label class="label" for="title">Title: </label>
                  </div>
                  <div class="field-body">
                     <div class="field">
                        <p class="control">
                           <input  class="input is-small" placeholder="Name of your property" id="title" name="title" type="text"/>
                        </p>
                     </div>
                  </div>
               </div>
                  <input type="hidden" th:value="${user.id}" th:name="userId">
               <div class="field is-horizontal">
                  <div class="field-label is-normal">
                     <label class="label" for="cost_per_day">Cost per day: </label>
                  </div>
                  <div class="field-body">
                     <div class="field">
                        <p class="control">
                           <input class="input is-small" id="cost_per_day" placeholder="$$$$$" name="cost"/>
                        </p>
                     </div>
                  </div>
               </div>
               <div class="field is-horizontal">
                  <div class="field-label is-normal">
                     <label class="label" for="address">Address: </label>
                  </div>
                  <div class="field-body">
                     <div class="field">
                        <p class="control">
                           <input class="input is-small" id="address" name="address" placeholder="Street, city, state, zip" required/>
                        </p>
                     </div>
                  </div>
               </div>
               <div class="field is-horizontal">
                  <div class="field-label is-normal">
                     <label class="label" for="description">Description:</label>
                  </div>
                  <div class="field-body">
                     <div class="field">
                        <p class="control">
                           <textarea class="textarea is-normal" placeholder="List what can be done at your place, how big your place is, and what amenities you provide." id="description" name="description"></textarea>
                        </p>
                     </div>
                  </div>
               </div>
               <!--    <div id="map" style="height: 400px; width: 400px;"></div>-->
               <div>
                  <h1 class="is-size-3">Choose up to 5 images:</h1>
                  <button id="showModal" class="button is-medium is-primary showModal" type="button">Add Image</button>
                  <br>
                  <button type="submit" class="button is-primary is-medium" style="margin-top: 2%; width: 139px">Submit</button>
                  <div>
                     <div id="image"
                          style="display: flex; justify-content: space-evenly; align-items: center; flex-wrap: wrap; height: 125px; width: 700px;"></div>


                     <div id="error"></div>

                  </div>
               </div>
            </form>
         </div>
      </div>
   </div>
</main>
<script type="text/javascript" src="/static/js/keys.js"></script>
<script type="text/javascript"
        src="//static.filestackapi.com/filestack-js/3.x.x/filestack.min.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.js"
        integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
        crossorigin="anonymous"></script>
<script>
    $(document).ready(function () {
        //filestack js
        let i = 0;
        const client = filestack.init("ArvmOJdHSwmo1NtHoPmi5z");
        const options = {
            onUploadDone: (res) => $('#image').append(`<input type="hidden" name="image_path` + i + `" value="https://cdn.filestackcontent.com/${res.filesUploaded[0].handle}"> <br> <img src="https://cdn.filestackcontent.com/${res.filesUploaded[0].handle}" alt="image of place" style="width: 100px; height: 100px;">`),
        };
        if (i <= 10) {

        $("#showModal").click(function () {
            i++;
            client.picker(options).open();
        });
        } else {
            $('#error').append(`<p>Sorry! No more than 5 pictures, please!</p>`)
        }
    });

</script>
</body>
</html>